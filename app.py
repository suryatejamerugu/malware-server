from selenium import webdriver
import time
from selenium.webdriver.common.keys import Keys
from selenium.webdriver.chrome.options import Options

options = Options()
options.add_argument("--use-fake-ui-for-media-stream")

browser = webdriver.Chrome("./chromedriver.exe",options=options)
a = "https://go.microsoft.com/fwlink/p/?LinkID=873020&clcid=0x4009&culture=en-in&country=IN&lm=deeplink&lmsrc=homePageWeb&cmpid=WebSignIn"
browser.get(a)
print("page loaded")
time.sleep(2)
email = browser.find_element_by_name("loginfmt")
email.send_keys("18481A05D7@gecgudlavallerumic.in")
email.send_keys(Keys.RETURN)
time.sleep(2)
password = browser.find_element_by_name("passwd")
password.send_keys("Suryateja@1461")
password.send_keys(Keys.RETURN)
time.sleep(2)
yes = browser.find_element_by_id("idSIButton9")
yes.click()
time.sleep(2)
useweb = browser.find_element_by_class_name("use-app-lnk")
useweb.click()
time.sleep(4)
AB = browser.find_elements_by_class_name("action-button ")
print(AB)
AB[1].click()
time.sleep(1)

l = browser.find_elements_by_class_name("team-card")
for i in l:
    tid = i.get_attribute("data-tid")
    print(tid)
    if(tid == "team-Testing Malware" ):
        i.click()
        break
time.sleep(5)
print("Waiting to load meetings")
join = browser.find_elements_by_tag_name("calling-join-button")
print(join)
join[0].find_elements_by_tag_name("button")[0].click()

try:
    browser.switch_to_alert().accept()
except:
    print("no allerts")

cms = browser.find_elements_by_tag_name("toggle-button")
for i in cms:
    state = i.get_attribute("title")
    print("State _ " + state)
    if state == "Turn camera off" or "Mute microphone":
        i.click()
        time.sleep(2)


l = browser.find_elements_by_class_name("button-col")[0].click()


