from selenium import webdriver
import time
from selenium.webdriver.common.keys import Keys
from selenium.webdriver.chrome.options import Options
from login import login
from common import Wait
from joinTeam import JoinTeam
from Sheduler import Get_present_Team_element
from GetTeams import GetTeams_ElementsAndNames,GetTeams_names

global Sleep_time,error_count
Sleep_time = 2
error_count = 10

se = "team-SE-CT2517-R17-2018-22-III-I-CSE-C"
wt = "team-WT-CSE2520-R17-2018-22-III-I-CSE-C"
cn = "team-CN-CT2519-R17-2018-22-III-I-CSE-C"
oe_1 = "team-C#.NET-PE-CS2506-R17-2018-22-III-I-CSE-II"
cd = "team-CD-CT2518-R17-2018-22-III-I-CSE-C"
oe_2 = "team-DS-CS2508-R17-2018-22-III-I-OE-II"
tm = "team-Testing Malware"
time_table = [
    [["09:00", "10:00", wt], ["10:00", "11:00", oe_1], ["11:00", "12:00", cn], ["12:00", "13:00", cd], ["14:00", "15:00", wt],["15:00", "16:00", wt]],
    [["09:00", "10:00", cd], ["10:00", "11:00", wt],["11:00", "12:00", se], ["12:00", "13:00", oe_2], ["14:00", "15:00", cn],["15:00", "16:00", cn]],
    [["09:00", "10:00", oe_1], ["10:00", "11:00", cd],["11:00", "12:00", cn], ["12:00", "13:00", wt], ["14:00", "15:00", cd],["15:00", "16:00", se]],
    [["09:00", "10:00", oe_2], ["10:00", "11:00", se],["11:00", "12:00", cd], ["12:00", "13:00", cn]],
    [["09:00", "10:00", se], ["10:00", "11:00", wt],["11:00", "12:00", oe_1], ["12:00", "13:00", cn], ["17:00","20:00",tm]],
    [["09:00", "10:00", cn], ["10:00", "11:00", oe_1],["11:00", "12:00", wt], ["12:00", "13:00", oe_2]],

]

options = Options()
options.add_argument("--use-fake-ui-for-media-stream")

browser = webdriver.Chrome("./chromedriver.exe",options=options)
initial_url = "https://go.microsoft.com/fwlink/p/?LinkID=873020&clcid=0x4009&culture=en-in&country=IN&lm=deeplink&lmsrc=homePageWeb&cmpid=WebSignIn"
emial = "18481A05D9@gecgudlavallerumic.in"
password = "Anji.1998"

login(browser,initial_url,emial,password)
res = Get_present_Team_element(browser,time_table)

JoinTeam(browser,res)
