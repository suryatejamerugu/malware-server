from datetime import datetime
from GetTeams import GetTeams_ElementsAndNames
import calendar

def Get_present_Team_element(browser,time_table):
    day_index = datetime.weekday(datetime.date(datetime.now()))
    day_name = calendar.day_name[day_index]
    if(type(time_table) == type(list())):
        if(len(time_table) < day_index) :
            return "No meetings"
        else :
            today_stadule = time_table[day_index]
    else :
        try :
            today_stadule = time_table[str(day_index)]
        except :
            return "No meetings"

    nh,nm = datetime.now().time().hour,datetime.now().time().minute
    now_time = ""
    if nh < 10:
        now_time += str(nh)+":"
    else:
        now_time += str(nh) + ":"
    if nm < 10:
        now_time += str(nm)
    else:
        now_time += str(nm)

    flag = True
    for s in today_stadule:
        start_time, end_time, team_name =  s["start_time"],s["end_time"],s["tname"]
        if start_time < now_time < end_time :
            flag = False
            team_card_elements,team_names = GetTeams_ElementsAndNames(browser)
            if team_name in team_names:
                return team_card_elements[team_names.index(team_name)],team_name,start_time,end_time
            else:
                print("Team name is not found Correct the time table...")
                return "timetable Error"
    if flag:
        print("No Meeting present now")
        return "No meetings"